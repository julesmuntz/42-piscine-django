{% extends 'd05/templates/form.html' %}

{% block content %}

<form method="post" id="updateForm">
	{% csrf_token %}
	<select name="title" class="select-dropdown" id="titleSelect">
		{% for title in titles %}
		<option value="{{ title }}" {% if title == selected_title %}selected{% endif %}>{{ title }}</option>
		{% endfor %}
	</select>
	<textarea name="opening_crawl" placeholder="New opening crawl..." rows="10" cols="50" class="textarea-field" id="openingCrawl">{{ current_opening_crawl }}</textarea>
	{{ block.super }}
</form>

<script>
	document.addEventListener('DOMContentLoaded', function() {
		const titleSelect = document.getElementById('titleSelect');
		titleSelect.addEventListener('change', function() {
			const form = document.createElement('form');
			form.method = 'GET';
			form.action = window.location.pathname;
			const titleInput = document.createElement('input');
			titleInput.type = 'hidden';
			titleInput.name = 'title';
			titleInput.value = this.value;
			form.appendChild(titleInput);
			document.body.appendChild(form);
			form.submit();
		});
	});
</script>

{% endblock %}